<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="l4l_sale_order_kpis_tree_inherit_sale_split" model="ir.ui.view">
        <field name="name">l4l.sale.order.kpis.tree.inherit.sale.split</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_quotation_tree_with_onboarding"/>
        <field name="arch" type="xml">
            <field name="state" position="before">
                <field name="delivery_state_progress" widget="percentpie" string="Progreso de estado"/>
            </field>
        </field>
    </record>

    <record id="l4l_split_sale_views_form" model="ir.ui.view">
        <field name="name">l4l.split.sale.views.form</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[hasclass('oe_button_box')]" position="inside">
                <button name="button_split_order" string="Dividir venta" type="object" invisible="state != 'draft'"
                        class="oe_highlight"/>
            </xpath>
            <xpath expr="//header" position="inside">
                <button name="action_pend" string="Pasar a pendiente" type="object" class="btn-primary"
                        invisible="state not in ('by_authorize')" groups="sales_team.group_sale_manager" />
                <button name="action_confirm" string="Confirmar" type="object" invisible="state not in ('pend')"
                        groups="sales_team.group_sale_manager" class="btn-primary" />
                <div>
                    <div>
                        <field name="checklist_state_progress" widget="percentpie" string=""/>
                    </div>
                </div>
            </xpath>

            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="delivered_count" invisible="1"/>
                <field name="total_count" invisible="1" />
                <field name="delivery_state_progress" widget="percentpie" string="Progress"/>
                <field name="sale_origin_id" invisible="not sale_origin_id" readonly="1"/>
            </xpath>
            <div>
                <button type="object" name="action_split_smart_button" class="split_order" icon="fa-random"
                        invisible="split_order_count == 0">
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_value">
                            <field name="split_order_count" widget="statinfo" nolabel="1" class="mr4"/>
                            Ã“rdenes hijas
                            <br/>
                        </span>
                    </div>
                </button>
            </div>
            <xpath expr="//notebook" position="inside">
                <page name="qty_delivered" string="Cantidades entregadas">
                     <field name="lines_delivered_ids" nolabel="1">
                        <tree edit="False" >
                            <field name="order_id"/>
                            <field name="x_order_line_id"/>
                            <field name="x_so_order_id"/>
                            <field name="qty_delivered"/>
                            <field name="product_uom_qty"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>
</odoo>